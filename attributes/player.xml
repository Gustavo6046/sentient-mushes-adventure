<?xml version="1.0"?>
<default>
    <function name="tick">
        def tick(entity):
            if entity['pickups'] &gt;= 20:
                entity['pickups'] = 0
                
            entity.call('creature_tick')
    </function>

    <function name="wield">
        def wield(entity, player, item=None):
            if entity['dead']:
                return
            
            if item is None:
                entity['weapon'] = None
                entity.world.broadcast(2, entity, ' is now fighting with their own body instead of a weapon!', entity.place)
                return
            
            else:
                i = entity.world.find_item(item)
                   
                if 'weapon' not in i['flags']:
                    player.print_out("{}: That is not a weapon, that's... another kind of item!".format(entity.name))
                    return
                
                if item not in entity['inventory'] or entity['inventory'][item] &lt;= 0:
                    player.print_out("{}: Imaginary weapons don't do real damage! You don't have that!".format(entity.name))
                    return
                    
                entity['weapon'] = item
                entity.world.broadcast(2, entity, ' is now wielding a {}!'.format(item), entity.place)
                
                return
    </function>

    <function name="player_move">
        def player_move(entity, player, place):
            player.print_out(entity, ' is attempting to move to ', place, '!')
            entity.call('pathmove', place)
    </function>
    
    <function name="craft">
        def craft(entity, player, desired, amount):
            if entity['dead']:
                return
        
            if not entity.world.find_item(desired):
                player.print_out(entity, "That recipe does not seem to exist.")
                return False
            
            if 'recipe' not in entity.world.find_item(desired)['attr']:
                player.print_out(entity, "That recipe does not seem to be possible. This is Einsteinian stuff!")
                return False
                
            for k, v in entity.world.find_item(desired)['attr']['recipe'].items():
                if k not in entity['inventory'] or entity['inventory'][k] &lt; world.find_item(desired)['recipe'][k] * amount:
                    player.print_out(entity, "You do not have enough {} to craft {} {} items ({}/{}).".format(k, amount, desired, entity['inventory'][k], world.find_item(desired)['recipe'][k] * amount))
                    return False
                    
            for r in enity.world.find_item(desired)['attr']['prerequisites']:
                if r not in entity['inventory'] or entity['inventory'][r] &lt;= 0:
                    player.print_out(entity, "As a prerequisite, you must have a {} in your inventory in order to craft a {}.".format(r, desired))
                    return False
            
            inv = entity['inventory']
                
            for k, v in entity.world.find_item(desired)['recipe'].items():
                inv[k] -= v * amount
                
            if desired not in inv:
                inv[desired] = amount
                
            else:
                inv[desired] += amount
                
            entity['inventory'] = inv
            player.print_out(entity, "{} {} items crafted successfully.".format(amount, desired))
            
            return True
    </function>
    
    <function name="player_attack">
        import random
    
        def player_attack(entity, other):
            if entity['dead'] or not other:
                return False
        
            entity.call('attack', other, (entity['punchDamage'] * random.uniform(0.7, 1.3) if (not entity['weapon'] or entity['inventory'].get(entity['weapon'], 0) &lt;= 0) else random.uniform(world.item_type(entity['weapon'])['attr']['minDamage'], world.item_type(entity['weapon'])['attr']['maxDamage'])))
            
            if entity['weapon'] and entity['inventory'].get(entity['weapon'], 0) > 0:
                if entity['weapon'] in entity['weaponUses']:
                    wu = entity['weaponUses']
                    wu[entity['weapon']] -= 1
                    entity['weaponUses'] = wu
                    
                else:
                    wu = entity['weaponUses']
                    wu[entity['weapon']] = world.item_type(entity['weapon'])['attr']['weaponUses'] - 1
                    entity['weaponUses'] = wu
                    
                if entity['weaponUses'][entity['weapon']] &lt;= 0:
                    entity['inventory'][entity['weapon']] = entity['inventory'][entity['weapon']] - 1
                    wu = entity['weaponUses']
                    wu[entity['weapon']] = world.item_type(entity['weapon'])['attr']['weaponUses']
                    entity['weaponUses'] = wu
                    
                    if entity['inventory'][entity['weapon']] &lt;= 0:
                        entity['weapon'] = None # back to bare hands, so don't forget to always wield a good weapon when one's available!
                        
            return True
    </function>
    
    <function name="pick_up">
        import random
        import namegen
        
        def plural(name, amount=2):
            if amount == 1:
                return name
            
            elif name.endswith('us') or name.endswith('is'):
                return name[:-2] + 'i'

            elif name[-1] == 's':
                return name + 'es'
                
            else:
                return name + 's',
        
        def pick_up(entity, player, amount=1, item=None):
            if entity['dead']:
                return False
        
            picked = {}
            
            a = 0
        
            while amount &gt;= 1:
                _item = item
            
                if item is None or item == "":
                    p = tuple(filter(lambda k: entity.world.find_place(entity.place)['items'][k] &gt; 0, tuple(entity.world.find_place(entity.place)['items'].keys())))
                
                    if p:
                        _item = random.choice(p)
                        
                    else:
                        player.print_out("No more items left at {}!".format(player.place))
                        break
                    
                elif _item not in entity.world.find_place(entity.place)['items'] or entity.world.find_place(entity.place)['items'][_item] &lt;= 0:
                    break
                    
                if _item in picked:
                    picked[_item] += 1
                    
                else:
                    picked[_item] = 1
                    
                entity.world.find_place(entity.place)['items'][_item] -= 1
                
                if entity.world.find_place(entity.place)['items'][_item] &lt;= 0:
                    entity.world.find_place(entity.place)['items'].pop(_item)
                    
                amount -= 1
                a += 1
            
            inv = entity['inventory'] # __setitem__ isn't perfect, yo
            
            for k, v in picked.items():
                if k in inv:
                    inv[k] += v
                    
                else:
                    inv[k] = v
            
            entity['inventory'] = inv
            entity['pickups'] += a
            
            if len(picked) > 0:
                print(plural(k, v))
                msg = "{} picks up {}!".format(entity.name, ', '.join("{} {}".format((('an' if k[0] in namegen.vowels else 'a') if v == 1 else v), plural(k, v)[0]) for k, v in picked.items()))
            
            if entity['pickups'] &gt;= 20:
                msg += " The turn is spent picking up all of these items."
                
            player.print_out(msg)
            
            return len(picked) &gt; 0
    </function>
    
    <attribute key="pickups" value="0" />
</default>